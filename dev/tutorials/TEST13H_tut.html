<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>TEST 13H: square plate under harmonic loading · FinEtoolsDeforLinear.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">FinEtoolsDeforLinear.jl</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="tutorials.html">Tutorials</a></li><li><a class="tocitem" href="../guide/guide.html">How to guide</a></li><li><span class="tocitem">Types and Functions</span><ul><li><a class="tocitem" href="../man/types.html">Types</a></li><li><a class="tocitem" href="../man/functions.html">Functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="TEST13H_tut.html">TEST 13H: square plate under harmonic loading</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="TEST13H_tut.html">TEST 13H: square plate under harmonic loading</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PetrKryslUCSD/FinEtoolsDeforLinear.jl/blob/master/docs/src/tutorials/TEST13H_tut.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="TEST-13H:-square-plate-under-harmonic-loading"><a class="docs-heading-anchor" href="#TEST-13H:-square-plate-under-harmonic-loading">TEST 13H: square plate under harmonic loading</a><a id="TEST-13H:-square-plate-under-harmonic-loading-1"></a><a class="docs-heading-anchor-permalink" href="#TEST-13H:-square-plate-under-harmonic-loading" title="Permalink"></a></h1><h2 id="Description"><a class="docs-heading-anchor" href="#Description">Description</a><a id="Description-1"></a><a class="docs-heading-anchor-permalink" href="#Description" title="Permalink"></a></h2><p>Harmonic forced vibration problem is solved for a homogeneous square plate, simply-supported on the circumference. This is the TEST 13H from the Abaqus v 6.12 Benchmarks manual. The test is recommended by the National Agency for Finite Element Methods and Standards (U.K.): Test 13 from NAFEMS “Selected Benchmarks for Forced Vibration,” R0016, March 1993.</p><p>The plate is discretized with hexahedral solid elements. The simple support condition is approximated by distributed rollers on the boundary. Because only the out of plane displacements are prevented, the structure has three rigid body modes in the plane of the plate.</p><p>Homogeneous square plate, simply-supported on the circumference from the test 13 from NAFEMS “Selected Benchmarks for Forced Vibration,” R0016, March 1993. The nonzero benchmark frequencies are (in hertz): 2.377, 5.961, 5.961, 9.483, 12.133, 12.133, 15.468, 15.468 [Hz].</p><pre><code class="language-julia">![](test13h_real_imag.png)</code></pre><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1] NAFEMS “Selected Benchmarks for Forced Vibration,” R0016, March 1993.</p><h2 id="Goals"><a class="docs-heading-anchor" href="#Goals">Goals</a><a id="Goals-1"></a><a class="docs-heading-anchor-permalink" href="#Goals" title="Permalink"></a></h2><ul><li>Show how to generate hexahedral mesh, mirroring and merging together parts.</li><li>Execute transient simulation by the trapezoidal-rule time stepping of [1].</li></ul><pre><code class="language-julia">#</code></pre><h2 id="Definitions"><a class="docs-heading-anchor" href="#Definitions">Definitions</a><a id="Definitions-1"></a><a class="docs-heading-anchor-permalink" href="#Definitions" title="Permalink"></a></h2><p>Bring in required support.</p><pre><code class="language-julia">using FinEtools
using FinEtoolsDeforLinear
using LinearAlgebra
using Arpack</code></pre><p>The input parameters come from [1].</p><pre><code class="language-julia">E = 200*phun(&quot;GPa&quot;);# Young&#39;s modulus
nu = 0.3;# Poisson ratio
rho = 8000*phun(&quot;kg*m^-3&quot;);# mass density
qmagn = 100.0*phun(&quot;Pa&quot;)
L = 10.0*phun(&quot;m&quot;); # side of the square plate
t = 0.05*phun(&quot;m&quot;); # thickness of the square plate
nL = 16; nt = 4;
tolerance = t/nt/100;
frequencies = vcat(linearspace(0.0,2.377,20), linearspace(2.377,15.0,70))</code></pre><p>Compute the parameters of Rayleigh damping. For the two selected frequencies we have the relationship between the damping ratio and the Rayleigh parameters</p><div>\[\xi_m=a_0/\omega_m+a_1\omega_m\]</div><p>where <span>$m=1,2$</span>.  Solving for the Rayleigh parameters <span>$a_0,a_1$</span> yields:</p><pre><code class="language-julia">zeta1 = 0.02; zeta2 = 0.02;
o1 = 2*pi*2.377;  o2 = 2*pi*15.468;
Rayleigh_mass = 2*(o1*o2)/(o2^2-o1^2)*(o2*zeta1-o1*zeta2);# a0
Rayleigh_stiffness = 2*(o1*o2)/(o2^2-o1^2)*(-1/o2*zeta1+1/o1*zeta2);# a1

Rayleigh_mass = Rayleigh_mass;
Rayleigh_stiffness = Rayleigh_stiffness;

MR = DeforModelRed3D
fens,fes  = H8block(L, L, t, nL, nL, nt)

geom = NodalField(fens.xyz)
u = NodalField(zeros(FCplxFlt, size(fens.xyz,1), 3)) # displacement field
nl = selectnode(fens, box=[0.0 0.0 -Inf Inf -Inf Inf], inflate=tolerance)
setebc!(u, nl, true, 3)
nl = selectnode(fens, box=[L L -Inf Inf -Inf Inf], inflate=tolerance)
setebc!(u, nl, true, 3)
nl = selectnode(fens, box=[-Inf Inf 0.0 0.0 -Inf Inf], inflate=tolerance)
setebc!(u, nl, true, 3)
nl = selectnode(fens, box=[-Inf Inf L L -Inf Inf], inflate=tolerance)
setebc!(u, nl, true, 3)
applyebc!(u)
numberdofs!(u)
println(&quot;nfreedofs = $(u.nfreedofs)&quot;)

material = MatDeforElastIso(MR, rho, E, nu, 0.0)

femm = FEMMDeforLinearMSH8(MR, IntegDomain(fes, GaussRule(3,2)), material)
femm = associategeometry!(femm, geom)
K = stiffness(femm, geom, u)
femm = FEMMDeforLinear(MR, IntegDomain(fes, GaussRule(3,3)), material)
M = mass(femm, geom, u)
C = Rayleigh_mass*M + Rayleigh_stiffness*K

bdryfes = meshboundary(fes)
topbfl = selectelem(fens, bdryfes, facing=true, direction=[0.0 0.0 1.0])
el1femm =  FEMMBase(IntegDomain(subset(bdryfes,topbfl), GaussRule(2,2)))
function pfun(forceout::FVec{T}, XYZ::FFltMat, tangents::FFltMat, fe_label::FInt) where {T}
    forceout .=  [0.0, 0.0, -qmagn]
    return forceout
end
fi = ForceIntensity(FFlt, 3, pfun);
F = distribloads(el1femm, geom, u, fi, 2);

print(&quot;Sweeping through $(length(frequencies))\n&quot;)
U1 = zeros(FCplxFlt, u.nfreedofs, length(frequencies))
for k in 1:length(frequencies)
    frequency = frequencies[k];
    omega = 2*pi*frequency;
    U1[:, k] = (-omega^2*M + 1im*omega*C + K)\F;
    print(&quot;.&quot;)
end
print(&quot;\n&quot;)

midpoint = selectnode(fens, box=[L/2 L/2 L/2 L/2 0 0], inflate=tolerance);
midpointdof = u.dofnums[midpoint, 3]

using PlotlyJS
umidAmpl = abs.(U1[midpointdof, :])/phun(&quot;MM&quot;)</code></pre><p>@pgf <em>a = SemiLogXAxis({     xlabel = &quot;Frequency [Hz]&quot;,     ylabel = &quot;Midpoint  displacement amplitude [mm]&quot;,     grid=&quot;major&quot;,     legend</em>pos  = &quot;south east&quot;,     title = &quot;Thin plate midpoint Amplitude FRF&quot; }, Plot({&quot;red&quot;, mark=&quot;triangle&quot;}, Table([:x =&gt; vec(frequencies), :y =&gt; vec(umidAmpl)])), LegendEntry(&quot;FEA&quot;)) display(_a)</p><p>Set up the layout:</p><pre><code class="language-julia">layout = Layout(;width=650, height=600, xaxis=attr(title=&quot;Frequency [Hz]&quot;, type = &quot;log&quot;), yaxis=attr(title=&quot;Midpoint  displacement amplitude [mm]&quot;, type = &quot;linear&quot;), title = &quot;Thin plate midpoint Amplitude FRF&quot;)</code></pre><p>Plot the graphs:</p><pre><code class="language-julia">plots = cat(scatter(;x=vec(frequencies), y=vec(umidAmpl), mode=&quot;lines&quot;, name = &quot;FEA&quot;, line_color = &quot;rgb(215, 15, 15)&quot;); dims = 1)
pl = plot(plots, layout; options = Dict(
        :showSendToCloud=&gt;true,
        :plotlyServerURL=&gt;&quot;https://chart-studio.plotly.com&quot;
        ))
display(pl)

umidReal = real.(U1[midpointdof, :])/phun(&quot;MM&quot;)
umidImag = imag.(U1[midpointdof, :])/phun(&quot;MM&quot;)</code></pre><p>@pgf <em>a = SemiLogXAxis({     xlabel = &quot;Frequency [Hz]&quot;,     ylabel = &quot;Displacement amplitude [mm]&quot;,     grid=&quot;major&quot;,     legend</em>pos  = &quot;south east&quot;,     title = &quot;Thin plate midpoint Real/Imag FRF&quot; }, Plot({&quot;red&quot;, mark=&quot;triangle&quot;}, Table([:x =&gt; vec(frequencies), :y =&gt; vec(umidReal)])), LegendEntry(&quot;real&quot;), Plot({&quot;blue&quot;, mark=&quot;circle&quot;}, Table([:x =&gt; vec(frequencies), :y =&gt; vec(umidImag)])), LegendEntry(&quot;imag&quot;)) display(_a)</p><pre><code class="language-julia">layout = Layout(;width=650, height=600, xaxis=attr(title=&quot;Frequency [Hz]&quot;, type = &quot;log&quot;), yaxis=attr(title=&quot;Midpoint  displacement amplitude [mm]&quot;, type = &quot;linear&quot;), title = &quot;Thin plate midpoint Real/Imag FRF&quot;)</code></pre><p>Plot the graphs:</p><pre><code class="language-julia">plots = cat(scatter(;x=vec(frequencies), y=vec(umidReal), mode=&quot;markers+lines&quot;, name = &quot;real&quot;, line_color = &quot;rgb(215, 15, 15)&quot;), scatter(;x=vec(frequencies), y=vec(umidImag), mode=&quot;markers+lines&quot;, name = &quot;imag&quot;, line_color = &quot;rgb(15, 15, 215)&quot;); dims = 1)
pl = plot(plots, layout; options = Dict(
        :showSendToCloud=&gt;true,
        :plotlyServerURL=&gt;&quot;https://chart-studio.plotly.com&quot;
        ))
display(pl)

umidPhase = atan.(umidImag,umidReal)/pi*180</code></pre><p>@pgf <em>a = SemiLogXAxis({     xlabel = &quot;Frequency [Hz]&quot;,     ylabel = &quot;Phase shift [deg]&quot;,     grid=&quot;major&quot;,     legend</em>pos  = &quot;south east&quot;,     title = &quot;Thin plate midpoint Real/Imag FRF&quot; }, Plot({&quot;red&quot;, mark=&quot;triangle&quot;}, Table([:x =&gt; vec(frequencies), :y =&gt; vec(umidPhase)])), LegendEntry(&quot;imag&quot;)) display(_a)</p><pre><code class="language-julia">layout = Layout(;width=650, height=600, xaxis=attr(title=&quot;Frequency [Hz]&quot;, type = &quot;log&quot;), yaxis=attr(title=&quot;Phase shift [deg]&quot;, type = &quot;linear&quot;), title = &quot;Thin plate midpoint FRF phase&quot;)</code></pre><p>Plot the graphs:</p><pre><code class="language-julia">plots = cat(scatter(;x=vec(frequencies), y=vec(umidPhase), mode=&quot;lines&quot;, name = &quot;phase&quot;, line_color = &quot;rgb(15, 215, 15)&quot;),; dims = 1)
pl = plot(plots, layout; options = Dict(
        :showSendToCloud=&gt;true,
        :plotlyServerURL=&gt;&quot;https://chart-studio.plotly.com&quot;
        ))
display(pl)

true</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 18 August 2020 16:45">Tuesday 18 August 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
